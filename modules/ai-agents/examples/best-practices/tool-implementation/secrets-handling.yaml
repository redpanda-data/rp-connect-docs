# Test: Proper secrets handling in MCP tools
# Validates: Environment variables used for secrets, not hardcoded values

label: fetch-api-data

processors:
  # tag::correct-vs-wrong[]
  # CORRECT: Secret from environment variable
  - http:
      url: "https://httpbin.org/get"
      verb: GET
      headers:
        Authorization: "Bearer ${API_TOKEN}"
      timeout: "10s"

  # WRONG (shown as comment - never do this):
  # - http:
  #     url: "https://api.example.com"
  #     headers:
  #       Authorization: "Bearer sk-1234567890abcdef"
  # end::correct-vs-wrong[]

  - mutation: |
      root = {
        "status": "success",
        "data_fetched": true
      }

meta:
  mcp:
    enabled: true
    description: "Fetch data from external API using secure credentials"
    properties:
      - name: query
        type: string
        description: "Query parameter"
        required: false
